<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://vk.com/js/api/openapi.js?159" type="text/javascript"></script>

    <script src="app/vkAppEvents.js" type="text/javascript"></script>
    <script src="app/eventBroker.js" type="text/javascript"></script>
    <script src="app/callService.js" type="text/javascript"></script>
    <script src="app/urlHelper.js" type="text/javascript"></script>
    <script src="app/appView.js" type="text/javascript"></script>
    <script src="app/app.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            var urlHelper = new UrlHelper();
            var callService = new CallService();
            var eventBroker = new EventBroker();
            var view = new AppView(eventBroker);
            var app = new VkApp(urlHelper, callService, view, eventBroker);

            $("#initAppButton").click(function () {
                var authResponseUrl = $("#loginResult").val();
                if (authResponseUrl) {
                    app.init(authResponseUrl);
                }
            });

            view.switchToInitializationMode();
        });


        function sendMessage() {
            var messageText = $("#messageText").val();

            VK.Api.call('messages.send', { user_id: 34545583, message: messageText, v: "5.73" }, function (r) {
                debugger;
            });
        }

    </script>

    <div class="initialization" style="display: none">
        <a href="login.html" target="_blank">Go to login page</a>
        <br />
        Paste login result here: <input id="loginResult" type="text" />
        <button id="initAppButton">Update auth token</button>
    </div>

    <div class="app" style="display: none">
        <div>
            <input type="text" id="postId" />
            <button id="getLikesButton">Get post likes</button>
        </div>
        <div class="likes-result">

        </div>

        <div class="message-panel" style="display:none">
            <input type="text" id="message" />
            <button id="sendMessageButton">Send message</button>
        </div>
    </div>

</body>
</html>